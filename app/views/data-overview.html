<div class="container" >

	<div class="row">
		<div class="col-xs-12">
			<a ui-sref="cbh.projects.list">
	        	<h2 class="nexa blue"><small><span class="glyphicon glyphicon-circle-arrow-left"></span>&nbsp;Back to project list</small></h2>
	        </a>
	    </div>
	</div>
	<div class="row">
		<div class="col-xs-12">
			<!-- <div class="form-group pull-right">
				<button type='submit' class="btn btn-primary"><span class="glyphicon glyphicon-plus-sign"></span> Add New</button>
			</div> -->
			<h2 class="blue"><span class="glyphicon glyphicon-list"></span> View Studies</h2>
		</div>
	</div>
	<div class="row">
		<div class="col-xs-12">
		<div  ng-repeat="form in assayctrl.proj.enabled_forms">
			<div  class="row" ng-if="$first">
				<div class="col-xs-6 bg-success" style="border: 1px solid #444; padding:10px; border-radius:5px; margin-bottom:20px;" >
					<div ng-repeat="level in ['l0']" class="col-xs-2">
						<!-- show only the first item as all l0 should be the same-->
						<div  >
							<small>{{form[level].data_type.name}}</small>
							<br>
							<strong class="nexa">{{form[level].name}}</strong>
						</div>
					</div>
				</div>
				
			</div>
			<div  class="row" eui-index="'cbh_queries'" eui-filter="ejs.BoolFilter().must(ejs.TermFilter('data_form_config.raw' , form.resource_uri)).must(ejs.TermFilter('l0_permitted_projects.raw', assayctrl.proj.resource_uri))" eui-enabled="true" >

				<div eui-aggregation="ejs.TermsAggregation('agg_name').field('l1.id')">
					<ul ng-repeat="bucket in aggResult.buckets" class="list-unstyled">
						<li ng-repeat="hit in indexVM.results.hits.hits" ng-if="hit._source.id != 1 ">
							<div class="pull-right" style="margin-right:10px;"><button class="btn btn-lg btn-default" ui-sref="cbh.projects.project.assay.view_data({'dc':form.id })">View Data >></button></div>
							<h2 class="subheading" style="margin-bottom:0;">
									{{form['l1'].name}}<br>
									<small>{{form['l1'].data_type.name}} <span class="glyphicon glyphicon-calendar"></span> last modified on {{hit._source['l1'].modified | date}}<br></small>
									
								</h2>
							<div class="col-xs-12 bg-warning" style="border: 1px solid #444; border-radius:5px; margin-bottom:20px; padding:10px;">

								
								<!-- {{form[level].project_data_fields[0].description}} -->
								
								<dl class="dl-horizontal" ng-repeat="(l1key, l1value) in hit._source['l1'].project_data">
									
									
									  <dt>{{l1key}}</dt>
									  <dd>{{l1value}}</dd>
									
								</dl>

								<div class="row" style="margin:10px 15px 0;">
									<div class="col-xs-6 bg-info" style="border-radius:5px; margin-bottom:20px; padding:10px;" ng-if="hit._source['l2'].id != 1">
										<strong>{{form['l2'].data_type.name}}</strong>
										<br>
										<strong class="nexa">{{form['l2'].name}}</strong><br>
										<span class="glyphicon glyphicon-calendar"></span>  <em>last modified on {{hit._source['l2'].modified | date}}</em>
										<dt ng-repeat="(l2key, l2value) in hit._source['l2'].project_data">
											<em>{{l2key}}</em> <br> {{l2value}}
										</dt>

										<button>Add {{form['l2'].data_type.name}}</button>

									</div>	
									<div class="col-xs-6 bg-success" style="border-radius:5px; margin-bottom:20px; padding:10px;" ng-if="hit._source['l3'].id != 1">
										<strong>{{form['l3'].data_type.name}}</strong>
										<br>
										<strong class="nexa">{{form['l3'].name}}</strong><br>
										<div ng-repeat="(l3key, l3value) in hit._source['l3'].project_data">
											<em>{{l3key}}</em> <br> {{l3value}}
										</div>
										<button>Add {{form['l3'].data_type.name}}</button>
									</div>	
								</div>

							</div>

							
							
							
								
							
						</li>

				    </ul>

				</div>

			</div>
		</div>
	</div>
	</div>

	
</div>
<!-- ejs.FilterAggregation(bucket.key).filter(ejs.TermFilter('data_form_config.id' , bucket.key)) -->