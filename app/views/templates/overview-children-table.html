<div class="col-xs-12 l3" style="border: 1px solid #444; border-radius:5px; margin-bottom:20px; padding-left:10px;padding-right:10px;">
    <div class="row" eui-index="'cbh_queries'"  eui-filter="ejs.BoolFilter().must(ejs.TermFilter('data_form_config.raw' ,dpclassif.next_level_dfc.resource_uri )).must(ejs.TermFilter('level_from', dpclassif.next_level)).must(ejs.TermFilter('l0_permitted_projects.raw', assayctrl.proj.resource_uri)).must(ejs.TermFilter('parent_id' ,dpclassif.id ))" eui-sort="ejs.Sort('modified').order('desc')" eui-enabled="true" style="margin:5px 5px 0;">
        <div class="col-xs-12 " style="border-radius:5px; padding:10px;">

            <div class="pull-left">
                <strong class="nexa">
                    <span style="color:#eee; background-color:#002147; padding:5px; border-radius:5px;">{{dpclassif.next_level_cfc.data_type.plural}}</span>
                </strong> 
                <span class="glyphicon glyphicon-calendar"></span>  
                <small><em>last modified on {{dpclassif.main_data.modified | date}}</em></small>
            </div>
            <div class="pull-right">
                <span><input type="text" eui-query="ejs.MultiMatchQuery([dpclassif.next_level + '.project_data_all'] , querystring).type('phrase_prefix')" ng-model="querystring" eui-enabled="querystring" eui-highlight="ejs.Highlight('*').preTags('<span class=\'highlighted\'>').postTags('</span>')"/></span>
                <span ng-include="'views/templates/download-results.html'"></span>
            </div>

        </div>



        <div class="col-xs-12">
            <div class="row table-responsive" style="background-color:white;" >

                <table class="table table-striped">

                    <thead>
                        <tr>
                            <th><small>
                                Actions 
                            </small></th>
                            <th ng-show="assayctrl.proj.project_type.show_compounds"><small>
                                Structure
                            </small></th>
                            <th ng-repeat="bottomlevelfield in dpclassif.next_level_cfc.project_data_fields">
                                <small>
                                    {{bottomlevelfield.name}}
                                </small>
                            </th>
                        </tr>
                    </thead>
                    <tbody>

                        <tr ng-repeat="childItem in indexVM.results.hits.hits" >
                            <td>
                                <a  ng-click="dpclassif.setChosenDataFormConfig(dpclassif.next_level_dfc.resource_uri, true, childItem._source[dpclassif.next_level])" > 
                                    <span class="hidden-xs hidden-sm" title="Duplicate">Duplicate</span>
                                </a>
                            </td>
                            <td ng-show="assayctrl.proj.project_type.show_compounds">
                                <img ng-if="childItem._source.imgSrc" ng-src="data:image/png;base64,{{childItem._source.imgSrc}}"></img>
                                <img ng-if="!childItem._source.imgSrc" ng-src="images/no-structure.png"></img>

                            </td>
                            <td style="line-height:0.9 !important;" ng-repeat="field in dpclassif.next_level_cfc.project_data_fields" >
                                <small ng-show="childItem.highlight[dpclassif.next_level + '.project_data.' + field.elasticsearch_fieldname]">
                                    <span ng-bind-html="childItem.highlight[dpclassif.next_level + '.project_data.' + field.elasticsearch_fieldname][0]"></span>
                                </small>
                                <small ng-hide="childItem.highlight[dpclassif.next_level + '.project_data.' + field.elasticsearch_fieldname]">
                                    {{childItem._source[dpclassif.next_level].project_data[field.elasticsearch_fieldname]}}
                                </small>
                                
                            </td>
                        </tr>
                        <tr ng-if="indexVM.results.hits.hits.length == 0" class="text-center"><td colspan="{{(1+ dpclassif.next_level_cfc.project_data_fields.length)}}" class="text-center">No results</td></tr>

                    </tbody>

                    
                </table>

                <div class="text-center">


                    <ul class="pager">

                        <li>{{indexVM.results.hits.total}} results </li>
                        <li ng-class="{disabled:indexVM.page <= 1}"><a href="" ng-click="indexVM.page=1">First</a></li>
                        <li ng-class="{disabled:indexVM.page <= 1}"><a href="" ng-click="indexVM.page=indexVM.page - 1">Previous</a></li>
                        <li>Page {{indexVM.page}} of {{indexVM.pageCount}}</li>
                        <li ng-class="{disabled:indexVM.pageCount <= indexVM.page}"><a href="" ng-click="indexVM.page=indexVM.page + 1">Next</a></li>
                        <li ng-class="{disabled:indexVM.pageCount <= indexVM.page}"><a href="" ng-click="indexVM.page=indexVM.pageCount">Last</a></li>
                        <li>
                            <select ng-model="indexVM.pageSize">
                                <option ng-repeat="item in [5, 10, 20]">{{item}}</option>
                            </select>
                            per page
                        </li>
                    </ul>
                </div>

            </div>
        </div>
        <!--here to make sure data binging works, dont delete before fixing binding-->
        <!-- <span style="visibility:hidden;font-size:1px;" ng-repeat="c in dpclassif.children" >{{c.created}}</span> -->
        <!--here to make sure data binging works, dont delete before fixing binding-->

        <!-- </div> -->

    </div>
</div>
